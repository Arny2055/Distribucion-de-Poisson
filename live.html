<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BetAGS - An치lisis Live Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #020617; color: #f8fafc; font-family: 'Inter', sans-serif; }
        .glass-card { background: rgba(15, 23, 42, 0.95); border: 1px solid rgba(255, 255, 255, 0.05); }
        .roi-positive { color: #10b981; text-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
        .roi-negative { color: #ef4444; }
        .input-manual { background: #020617; border: 1px solid #1e293b; border-radius: 6px; color: white; font-size: 11px; padding: 5px; width: 100%; outline: none; }
        .input-manual-large { font-size: 16px !important; padding: 10px !important; text-align: center !important; font-weight: 800 !important; }
        .xg-input-xl { font-size: 24px !important; padding: 12px !important; height: auto !important; }
        .prob-box { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 1rem; padding: 1.5rem; text-align: center; }
        .prob-value { font-size: 3rem; font-weight: 900; line-height: 1; margin-bottom: 0.5rem; }
        .prob-label { font-size: 0.75rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.1em; }
    </style>
</head>
<body>
    <nav class="p-4 bg-black/60 border-b border-emerald-500/10 backdrop-blur-md sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tighter">BETAGS <span class="text-amber-500">PROBABILIDAD LIVE</span></h1>
        </div>
    </nav>

    <div class="container mx-auto p-4 max-w-6xl">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <div class="lg:col-span-1 space-y-6">
                <div class="glass-card p-5 rounded-2xl border-dashed border-amber-500/30 bg-amber-500/5">
                    <p class="text-[10px] text-amber-500 font-black uppercase mb-3 tracking-widest text-center">Configuraci칩n de xG</p>
                    <div class="space-y-4">
                        <input type="text" id="manual-teams" placeholder="EQUIPO A VS EQUIPO B" class="input-manual input-manual-large">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="text-[10px] text-slate-500 font-black uppercase mb-1 block text-center">xG Local</label>
                                <input type="number" id="manual-xg-h" step="0.01" placeholder="0.00" class="input-manual xg-input-xl text-center font-black text-emerald-400">
                            </div>
                            <div>
                                <label class="text-[10px] text-slate-500 font-black uppercase mb-1 block text-center">xG Visita</label>
                                <input type="number" id="manual-xg-a" step="0.01" placeholder="0.00" class="input-manual xg-input-xl text-center font-black text-amber-400">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-6 rounded-2xl">
                    <p class="text-[10px] text-slate-400 font-bold uppercase mb-4 text-center">Minuto de Entrada</p>
                    <input type="number" id="live-min-start" value="0" min="0" max="90" 
                           class="w-full bg-slate-950 border border-emerald-500/30 rounded-xl p-4 text-4xl text-white font-black text-center outline-none focus:border-emerald-500" 
                           oninput="calculateLive()">
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="prob-box border-emerald-500/20">
                        <p class="prob-label">Over 0.5 HT (0-45')</p>
                        <div id="prob-o05-ht" class="prob-value text-emerald-400">--%</div>
                        <p id="fair-o05-ht" class="text-xs font-mono text-slate-500">Cuota: --</p>
                    </div>
                    <div class="prob-box border-emerald-500/20">
                        <p class="prob-label">Over 1.5 HT (0-45')</p>
                        <div id="prob-o15-ht" class="prob-value text-emerald-500">--%</div>
                        <p id="fair-o15-ht" class="text-xs font-mono text-slate-500">Cuota: --</p>
                    </div>
                    <div class="prob-box border-blue-500/20">
                        <p class="prob-label">Over 1.5 FT (0-90')</p>
                        <div id="prob-o15-ft" class="prob-value text-blue-400">--%</div>
                        <p id="fair-o15-ft" class="text-xs font-mono text-slate-500">Cuota: --</p>
                    </div>
                    <div class="prob-box border-blue-500/20">
                        <p class="prob-label">Over 2.5 FT (0-90')</p>
                        <div id="prob-o25-ft" class="prob-value text-blue-400">--%</div>
                        <p id="fair-o25-ft" class="text-xs font-mono text-slate-500">Cuota: --</p>
                    </div>
                    <div class="prob-box border-amber-500/20 md:col-span-2">
                        <p class="prob-label">Ambos Anotan (BTTS YES)</p>
                        <div id="prob-btts" class="prob-value text-amber-400">--%</div>
                        <p id="fair-btts" class="text-xs font-mono text-slate-500">Cuota: --</p>
                    </div>
                </div>
                
                <button onclick="calculateLive()" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-black py-4 rounded-xl transition-all uppercase tracking-widest shadow-lg">
                    Actualizar Probabilidades Live
                </button>
            </div>
        </div>
    </div>

    <script>
        function poisson(k, lambda) {
            if(lambda <= 0) return k === 0 ? 1 : 0;
            let factorial = 1;
            for (let i = 2; i <= k; i++) factorial *= i;
            return (Math.pow(lambda, k) * Math.exp(-lambda)) / factorial;
        }

        function calculateLive() {
            const xgH = parseFloat(document.getElementById('manual-xg-h').value) || 0;
            const xgA = parseFloat(document.getElementById('manual-xg-a').value) || 0;
            const currentMin = parseInt(document.getElementById('live-min-start').value) || 0;
            
            const lambdaTotal = xgH + xgA;
            if (lambdaTotal <= 0) return;

            // Fracci칩n de tiempo restante para HT (45 min) y FT (90 min)
            const timeRemHT = Math.max(0, 45 - currentMin);
            const timeRemFT = Math.max(0, 90 - currentMin);

            const lambdaHT = lambdaTotal * (timeRemHT / 90);
            const lambdaFT = lambdaTotal * (timeRemFT / 90);
            
            // Especial para BTTS (Probabilidad combinada aproximada)
            const lambdaH_FT = xgH * (timeRemFT / 90);
            const lambdaA_FT = xgA * (timeRemFT / 90);

            // C치lculos
            const o05ht = 1 - poisson(0, lambdaHT);
            const o15ht = 1 - (poisson(0, lambdaHT) + poisson(1, lambdaHT));
            const o15ft = 1 - (poisson(0, lambdaFT) + poisson(1, lambdaFT));
            const o25ft = 1 - (poisson(0, lambdaFT) + poisson(1, lambdaFT) + poisson(2, lambdaFT));
            const btts = (1 - Math.exp(-lambdaH_FT)) * (1 - Math.exp(-lambdaA_FT));

            // Actualizar UI
            updateDisplay('prob-o05-ht', 'fair-o05-ht', o05ht);
            updateDisplay('prob-o15-ht', 'fair-o15-ht', o15ht);
            updateDisplay('prob-o15-ft', 'fair-o15-ft', o15ft);
            updateDisplay('prob-o25-ft', 'fair-o25-ft', o25ft);
            updateDisplay('prob-btts', 'fair-btts', btts);
        }

        function updateDisplay(probId, fairId, value) {
            const p = Math.max(0, Math.min(0.99, value));
            document.getElementById(probId).innerText = (p * 100).toFixed(1) + "%";
            document.getElementById(fairId).innerText = "Cuota Justa: " + (p > 0 ? (1/p).toFixed(2) : "N/A");
        }
    </script>
</body>
</html>